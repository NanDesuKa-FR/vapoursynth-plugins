#!/bin/sh

pkgname="vapoursynth-extra-plugins"

if test x"$1" = x"-h" -o x"$1" = x"--help" ; then
cat << EOF
Usage: ./configure [options]

options:
  -h, --help               print this message
  --prefix=PREFIX          install files into PREFIX [/usr/local]
  --libdir=LIBDIR          install VapourSynth plugins directory
                           into LIBDIR [PREFIX/lib]
  --docdir=DOCDIR          install documents into DOCDIR
                           [PREFIX/share/doc/${pkgname}]
EOF
exit 1
fi

execstack=""
which execstack >/dev/null
if test $(echo $?) -ne 0 ; then
    echo "execstack not found!"
    exit 1
fi
execstack=$(which execstack)

for opt; do
    optarg="${opt#*=}"
    case "$opt" in
        --prefix=*)
            prefix="$optarg"
            ;;
        --libdir=*)
            libdir="$optarg"
            ;;
        --docdir=*)
            docdir="$optarg"
            ;;
        *)
            ;;
    esac
done

test -n "$prefix" || prefix="/usr/local"
test -n "$libdir" || libdir="\${prefix}/lib"
test -n "$docdir" || docdir="\${prefix}/share/doc/${pkgname}"

rm -f Makefile
cat >> Makefile << EOF
prefix = $prefix
libdir = $libdir
docdir = $docdir
execstack = $execstack
EOF
cat Makefile.in >> Makefile

echo "prefix = $prefix"
echo "libdir = $libdir"
echo "docdir = $docdir"
echo "execstack = $execstack"
echo "Now run 'make && make install'"

exit 0
